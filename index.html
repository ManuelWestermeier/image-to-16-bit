<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Image to 16-bit RGB Converter</title>
<style>
  body { font-family: sans-serif; padding: 20px; }
  canvas { display: none; }
  textarea { width: 100%; height: 200px; margin-top: 10px; }
</style>
</head>
<body>
<h1>Image to 16-bit RGB Converter</h1>
<input type="file" id="fileInput" accept="image/*">
<br><br>
<button id="convertBtn">Convert Image</button>
<textarea id="output" readonly></textarea>

<canvas id="canvas"></canvas>

<script>
function RGB(r, g, b) {
    return ((r & 0xF8) << 8) | ((g & 0xFC) << 3) | ((b & 0xF8) >> 3);
}

document.getElementById('convertBtn').addEventListener('click', () => {
    const fileInput = document.getElementById('fileInput');
    if (!fileInput.files[0]) {
        alert("Please select an image first!");
        return;
    }

    const reader = new FileReader();
    reader.onload = function(e) {
        const img = new Image();
        img.onload = function() {
            const canvas = document.getElementById('canvas');
            canvas.width = img.width;
            canvas.height = img.height;
            const ctx = canvas.getContext('2d');
            ctx.drawImage(img, 0, 0);

            const imgData = ctx.getImageData(0, 0, img.width, img.height).data;
            let outputText = `// Width: ${img.width}, Height: ${img.height}\n`;
            outputText += `const uint16_t imageData[${img.width * img.height}] = {\n`;

            for (let i = 0; i < imgData.length; i += 4) {
                const r = imgData[i];
                const g = imgData[i+1];
                const b = imgData[i+2];
                const color = RGB(r, g, b);
                outputText += `0x${color.toString(16).padStart(4,'0')},`;
                if ((i/4 + 1) % img.width === 0) outputText += '\n';
            }

            outputText += '};';
            document.getElementById('output').value = outputText;
        }
        img.src = e.target.result;
    }
    reader.readAsDataURL(fileInput.files[0]);
});
</script>
</body>
</html>
